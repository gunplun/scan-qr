<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="th"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;สแกน QR โต๊ะทำงาน&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script src="https://unpkg.com/html5-qrcode" type="text/javascript"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>body {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-family: 'Segoe UI', 'Roboto', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background-color: #f4f6f8;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">      </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">      </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">      </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">      </span>justify-content: flex-start;</p>
<p class="p1"><span class="Apple-converted-space">      </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>header {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>background: #0d6efd;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding: 16px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 1.4rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">      </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 0 0 16px 16px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: 0 4px 10px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>#reader {</p>
<p class="p1"><span class="Apple-converted-space">      </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">      </span>max-width: 400px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>border-radius: 16px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">      </span>box-shadow: 0 4px 20px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>#status {</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-top: 20px;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #28a745;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>footer {</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-size: 0.8rem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #888;</p>
<p class="p1"><span class="Apple-converted-space">      </span>margin-top: auto;</p>
<p class="p1"><span class="Apple-converted-space">      </span>padding-top: 30px;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>.warning {</p>
<p class="p1"><span class="Apple-converted-space">      </span>color: #dc3545;</p>
<p class="p1"><span class="Apple-converted-space">      </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;header&gt;📷 สแกน QR โต๊ะทำงาน&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="reader"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="status"&gt;กำลังขอสิทธิ์กล้อง...&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSe_HSHdDyoEFAcYR1YOaCzPNv1DbNDSdxBsyNJXg6kDIOOCNQ/viewform?usp=pp_url&amp;entry.178830938=";</p>
<p class="p1"><span class="Apple-converted-space">    </span>let html5QrcodeScanner;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function startQrScanner() {</p>
<p class="p1"><span class="Apple-converted-space">      </span>html5QrcodeScanner = new Html5QrcodeScanner(</p>
<p class="p1"><span class="Apple-converted-space">        </span>"reader", { fps: 10, qrbox: { width: 250, height: 250 } }, false);</p>
<p class="p1"><span class="Apple-converted-space">      </span>html5QrcodeScanner.render(onScanSuccess, onScanError);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function onScanSuccess(decodedText, decodedResult) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>document.getElementById("status").innerText = "✅ สแกนแล้ว: " + decodedText;</p>
<p class="p1"><span class="Apple-converted-space">      </span>html5QrcodeScanner.clear().then(_ =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>window.location.href = formBase + encodeURIComponent(decodedText);</p>
<p class="p1"><span class="Apple-converted-space">      </span>}).catch(error =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>console.error("ไม่สามารถปิดกล้องได้:", error);</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function onScanError(errorMessage) {}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>navigator.mediaDevices.getUserMedia({ video: true })</p>
<p class="p1"><span class="Apple-converted-space">      </span>.then(function(stream) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById("status").innerText = "📷 พร้อมสแกนแล้ว";</p>
<p class="p1"><span class="Apple-converted-space">        </span>stream.getTracks().forEach(track =&gt; track.stop());</p>
<p class="p1"><span class="Apple-converted-space">        </span>startQrScanner();</p>
<p class="p1"><span class="Apple-converted-space">      </span>})</p>
<p class="p1"><span class="Apple-converted-space">      </span>.catch(function(error) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>console.error('Camera permission denied:', error);</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById("status").innerHTML = "&lt;span class='warning'&gt;❌ กรุณาอนุญาตกล้อง (เปิดผ่าน Chrome หรือ Safari เท่านั้น)&lt;/span&gt;";</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;footer&gt;บริษัทคลาวด์ จำกัด © 2024&lt;/footer&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
